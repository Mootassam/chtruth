"use strict";(self.webpackChunkapp_frontend=self.webpackChunkapp_frontend||[]).push([[1972],{15021:function(e,t,n){var s=n(76747),a=n(86495),r=n(26319),o=n(71945),c=(0,s.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new r.Z(e,t).match(o.Z.values.userRead)})),l=(0,s.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new r.Z(e,t).match(o.Z.values.userEdit)})),i=(0,s.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new r.Z(e,t).match(o.Z.values.userDestroy)})),d={selectPermissionToRead:c,selectPermissionToEdit:l,selectPermissionToCreate:(0,s.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new r.Z(e,t).match(o.Z.values.userCreate)})),selectPermissionToImport:(0,s.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new r.Z(e,t).match(o.Z.values.userImport)})),selectPermissionToDestroy:i};t.Z=d},1972:function(e,t,n){n.r(t),n.d(t,{default:function(){return re}});var s=n(47313),a=n(10499),r=n(27829),o=n(75352),c=n(22102),l=n(63849),i=n(31616),d=n(70885),u=n(23516),m=n(76747),h=n(86495),f=n(26319),x=n(71945),Z=(0,m.P1)([h.Z.selectCurrentTenant,h.Z.selectCurrentUser],(function(e,t){return new f.Z(e,t).match(x.Z.values.categoryRead)})),p=(0,m.P1)([h.Z.selectCurrentTenant,h.Z.selectCurrentUser],(function(e,t){return new f.Z(e,t).match(x.Z.values.categoryRead)})),v=(0,m.P1)([h.Z.selectCurrentTenant,h.Z.selectCurrentUser],(function(e,t){return new f.Z(e,t).match(x.Z.values.categoryRead)})),j=(0,m.P1)([h.Z.selectCurrentTenant,h.Z.selectCurrentUser],(function(e,t){return new f.Z(e,t).match(x.Z.values.categoryRead)})),b={selectPermissionToRead:Z,selectPermissionToEdit:p,selectPermissionToCreate:v,selectPermissionToDestroy:(0,m.P1)([h.Z.selectCurrentTenant,h.Z.selectCurrentUser],(function(e,t){return new f.Z(e,t).match(x.Z.values.categoryRead)})),selectPermissionToImport:j},g=n(74165),C=n(15861),N=n(8568),T=n(13929),y=n(33512),S=n(40476),R=n(14122),w="COUPONS_DESTROY",E={DESTROY_STARTED:"".concat(w,"_DESTROY_STARTED"),DESTROY_SUCCESS:"".concat(w,"_DESTROY_SUCCESS"),DESTROY_ERROR:"".concat(w,"_DESTROY_ERROR"),DESTROY_ALL_STARTED:"".concat(w,"_DESTROY_ALL_STARTED"),DESTROY_ALL_SUCCESS:"".concat(w,"_DESTROY_ALL_SUCCESS"),DESTROY_ALL_ERROR:"".concat(w,"_DESTROY_ALL_ERROR"),doDestroy:function(e){return function(){var t=(0,C.Z)((0,g.Z)().mark((function t(n){return(0,g.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:E.DESTROY_STARTED}),t.next=4,T.Z.destroyAll([e]);case 4:n({type:E.DESTROY_SUCCESS}),R.Z.success((0,a.ag)("entities.vip.destroy.success")),n(N.Z.doFetchCurrentFilter()),(0,S.s1)().push("/notification"),t.next=15;break;case 10:t.prev=10,t.t0=t.catch(0),y.Z.handle(t.t0),n(N.Z.doFetchCurrentFilter()),n({type:E.DESTROY_ERROR});case 15:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},doDestroyAll:function(e){return function(){var t=(0,C.Z)((0,g.Z)().mark((function t(n){return(0,g.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:E.DESTROY_ALL_STARTED}),t.next=4,T.Z.destroyAll(e);case 4:n({type:E.DESTROY_ALL_SUCCESS}),N.Z&&(n(N.Z.doClearAllSelected()),n(N.Z.doFetchCurrentFilter())),R.Z.success((0,a.ag)("entities.vip.destroyAll.success")),(0,S.s1)().push("/notification"),t.next=15;break;case 10:t.prev=10,t.t0=t.catch(0),y.Z.handle(t.t0),n(N.Z.doFetchCurrentFilter()),n({type:E.DESTROY_ALL_ERROR});case 15:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}},k=E,P={selectLoading:(0,m.P1)([function(e){return e.vip.destroy}],(function(e){return Boolean(e.loading)}))},_=n(74554),D=n(45788),O=n(28303),A=n(44587),L=n(95748),U=n(10419),Y=n(28745),I=n(46417);var F=function(e){var t=(0,s.useState)(!1),n=(0,d.Z)(t,2),r=n[0],o=n[1],c=(0,D.I0)(),l=(0,D.v9)(_.Z.selectSelectedKeys),i=(0,D.v9)(_.Z.selectLoading),m=(0,D.v9)(P.selectLoading),h=(0,D.v9)(_.Z.selectExportLoading),f=(0,D.v9)(_.Z.selectHasRows),x=(0,D.v9)(u.Z.selectPermissionToRead),Z=(0,D.v9)(b.selectPermissionToDestroy),p=(0,D.v9)(b.selectPermissionToCreate),v=(0,D.v9)(b.selectPermissionToImport),j=function(){o(!0)},g=function(){o(!1)},C=function(){c(N.Z.doExport())};return(0,I.jsxs)(U.Z,{children:[p&&(0,I.jsx)(O.rU,{to:"/notification/new",children:(0,I.jsxs)("span",{"data-tip":(0,a.ag)("common.new"),"data-for":"charge-list-toolbar-new-tooltip",children:[(0,I.jsx)("button",{className:"btn btn-primary",type:"button",children:(0,I.jsx)(L.Z,{iconClass:"fas fa-plus"})}),(0,I.jsx)(Y.Z,{id:"charge-list-toolbar-new-tooltip"})]})}),v&&(0,I.jsx)(O.rU,{to:"/notification/importer",children:(0,I.jsxs)("span",{"data-tip":(0,a.ag)("common.import"),"data-for":"charge-list-toolbar-import-tooltip",children:[(0,I.jsx)("button",{className:"btn btn-primary",type:"button",children:(0,I.jsx)(L.Z,{iconClass:"fas fa-upload"})}),(0,I.jsx)(Y.Z,{id:"charge-list-toolbar-import-tooltip"})]})}),function(){if(!Z)return null;var e=!l.length||i,t=(0,I.jsx)("button",{disabled:e,className:"btn btn-primary",type:"button",onClick:j,children:(0,I.jsx)(L.Z,{loading:m,iconClass:"far fa-trash-alt"})});return e?(0,I.jsxs)("span",{"data-tip":(0,a.ag)("common.mustSelectARow"),"data-tip-disable":!e,"data-for":"coupons-list-toolbar-destroy-tooltip",children:[t,(0,I.jsx)(Y.Z,{id:"coupons-list-toolbar-destroy-tooltip"})]}):t}(),x&&(0,I.jsx)(O.rU,{to:"/audit-logs?entityNames=coupons",children:(0,I.jsxs)("span",{"data-tip":(0,a.ag)("auditLog.menu"),"data-for":"charge-list-toolbar-auditLog-tooltip",children:[(0,I.jsx)("button",{className:"btnCircle btn-light",type:"button",children:(0,I.jsx)(L.Z,{iconClass:"fas fa-history"})}),(0,I.jsx)(Y.Z,{id:"charge-list-toolbar-auditLog-tooltip"})]})}),function(){var e=!f||i,t=(0,I.jsxs)("span",{"data-tip":(0,a.ag)("common.export"),"data-for":"charge-list-toolbar-export",children:[(0,I.jsx)("button",{className:"btnCircle btn-light",disabled:e,onClick:C,type:"button",children:(0,I.jsx)(L.Z,{loading:h,iconClass:"far fa-file-excel"})}),(0,I.jsx)(Y.Z,{id:"charge-list-toolbar-export"})]});return e?(0,I.jsxs)("span",{"data-tip":(0,a.ag)("common.noDataToExport"),"data-tip-disable":!e,"data-for":"coupons-list-toolbar-export-tooltip",children:[t,(0,I.jsx)(Y.Z,{id:"coupons-list-toolbar-export-tooltip"})]}):t}(),r&&(0,I.jsx)(A.Z,{title:(0,a.ag)("common.areYouSure"),onConfirm:function(){return g(),void c(k.doDestroyAll(l))},onClose:function(){return g()},okText:(0,a.ag)("common.yes"),cancelText:(0,a.ag)("common.no")})]})},V=n(1413),$=n(61567),B=n(97249),M=n(1296),H=n(80040);var K=function(e){var t=(0,s.useState)(null),n=(0,d.Z)(t,2),r=n[0],o=n[1],c=(0,D.I0)(),l=(0,D.v9)(_.Z.selectLoading),i=(0,D.v9)(P.selectLoading),u=l||i,m=(0,D.v9)(_.Z.selectRows),h=(0,D.v9)(_.Z.selectPagination),f=(0,D.v9)(_.Z.selectSelectedKeys),x=(0,D.v9)(_.Z.selectHasRows),Z=(0,D.v9)(_.Z.selectSorter),p=(0,D.v9)(_.Z.selectIsAllSelected),v=((0,D.v9)(b.selectPermissionToEdit),(0,D.v9)(b.selectPermissionToDestroy),function(){return o(null)}),j=function(e,t){var n=(0,V.Z)((0,V.Z)({},e),{},{status:t});c(H.Z.Update(e.id,n))},g=function(e){var t=Z.field===e&&"ascend"===Z.order?"descend":"ascend";c(N.Z.doChangeSort({field:e,order:t}))};return(0,I.jsxs)("div",{className:"spot-list-container",children:[(0,I.jsx)("div",{className:"table-responsive",children:(0,I.jsxs)("table",{className:"notification-table",children:[(0,I.jsx)("thead",{className:"table-header",children:(0,I.jsxs)("tr",{children:[(0,I.jsx)("th",{className:"checkbox-column",children:x&&(0,I.jsx)("div",{className:"checkbox-wrapper",children:(0,I.jsx)("input",{type:"checkbox",className:"form-checkbox",checked:Boolean(p),onChange:function(){return c(N.Z.doToggleAllSelected())}})})}),(0,I.jsxs)("th",{className:"sortable-header",onClick:function(){return g("userId")},children:[(0,a.ag)("entities.notification.fields.user"),"userId"===Z.field&&(0,I.jsx)("span",{className:"sort-icon",children:"ascend"===Z.order?"\u2191":"\u2193"})]}),(0,I.jsxs)("th",{className:"sortable-header",onClick:function(){return g("type")},children:[(0,a.ag)("entities.notification.fields.type"),"type"===Z.field&&(0,I.jsx)("span",{className:"sort-icon",children:"ascend"===Z.order?"\u2191":"\u2193"})]}),(0,I.jsx)("th",{className:"table-cell",children:(0,a.ag)("entities.notification.fields.message")}),(0,I.jsxs)("th",{className:"sortable-header",onClick:function(){return g("status")},children:[(0,a.ag)("entities.notification.fields.status"),"status"===Z.field&&(0,I.jsx)("span",{className:"sort-icon",children:"ascend"===Z.order?"\u2191":"\u2193"})]}),(0,I.jsx)("th",{className:"actions-header",children:"Actions"})]})}),(0,I.jsxs)("tbody",{className:"table-body",children:[u&&(0,I.jsx)("tr",{children:(0,I.jsx)("td",{colSpan:6,className:"loading-cell",children:(0,I.jsxs)("div",{className:"loading-container",children:[(0,I.jsx)($.Z,{}),(0,I.jsx)("span",{className:"loading-text",children:"Loading data..."})]})})}),!u&&m.map((function(e){return(0,I.jsxs)("tr",{className:"table-row",children:[(0,I.jsx)("td",{className:"checkbox-column",children:(0,I.jsx)("div",{className:"checkbox-wrapper",children:(0,I.jsx)("input",{type:"checkbox",className:"form-checkbox",checked:f.includes(e.id),onChange:function(){return t=e.id,c(N.Z.doToggleOneSelected(t));var t}})})}),(0,I.jsx)("td",{className:"table-cell",children:(0,I.jsx)(M.Z,{value:e.userId})}),(0,I.jsx)("td",{className:"table-cell",children:e.type}),(0,I.jsx)("td",{className:"table-cell",children:e.message}),(0,I.jsx)("td",{className:"table-cell",children:(0,I.jsx)("span",{className:"status-badge ".concat(e.status),children:e.status})}),(0,I.jsx)("td",{className:"actions-cell",children:(0,I.jsx)("div",{className:"actions-container",children:"unread"===e.status?(0,I.jsx)("button",{className:"btn-action edit",onClick:function(){return j(e,"read")},children:"Mark as Read"}):(0,I.jsx)("button",{className:"btn-action delete",onClick:function(){return j(e,"unread")},children:"Mark as Unread"})})})]},e.id)}))]})]})}),(0,I.jsx)("div",{className:"pagination-container",children:(0,I.jsx)(B.Z,{onChange:function(e){c(N.Z.doChangePagination(e))},disabled:u,pagination:h})}),r&&(0,I.jsx)(A.Z,{title:(0,a.ag)("common.areYouSure"),onConfirm:function(){return e=r,v(),void c(k.doDestroy(e));var e},onClose:v,okText:(0,a.ag)("common.yes"),cancelText:(0,a.ag)("common.no")})]})},G=n(43270),X=n(47590),q=n(69138),z=n(3463),J=n(67357),Q=n(13586),W=n(40846),ee=n(68031),te=z.Ry().shape({user:X.Z.relationToOne((0,a.ag)("entities.transaction.fields.user"))}),ne={},se={user:{label:(0,a.ag)("entities.transaction.fields.user"),render:W.Z.relationToOne()}};var ae=function(e){var t=(0,D.v9)(_.Z.selectRawFilter),n=(0,D.I0)(),r=(0,s.useState)(!1),o=(0,d.Z)(r,2),c=o[0],l=o[1],i=(0,s.useState)((function(){return(0,V.Z)((0,V.Z)({},ne),t)})),u=(0,d.Z)(i,1)[0],m=(0,G.cI)({resolver:(0,J.X)(te),defaultValues:u,mode:"all"});(0,s.useEffect)((function(){n(N.Z.doFetch(te.cast(u),t))}),[n]);var h=function(e){var t=m.getValues();n(N.Z.doFetch(e,t)),l(!1)};return(0,I.jsxs)(q.Z,{children:[(0,I.jsx)(Q.Z,{onClick:function(){l(!c)},renders:se,values:t,expanded:c,onRemove:function(e){return m.setValue(e,ne[e]),m.handleSubmit(h)()}}),(0,I.jsx)("div",{className:"container",children:(0,I.jsx)("div",{className:"collapse ".concat(c?"show":""),children:(0,I.jsx)(G.RV,(0,V.Z)((0,V.Z)({},m),{},{children:(0,I.jsxs)("form",{onSubmit:m.handleSubmit(h),children:[(0,I.jsx)("div",{className:"row",children:(0,I.jsx)("div",{className:"col-lg-6 col-12",children:(0,I.jsx)(ee.Z,{name:"userId",label:(0,a.ag)("entities.transaction.fields.user")})})}),(0,I.jsx)("div",{className:"row",children:(0,I.jsxs)("div",{className:"col-12 filter-buttons",children:[(0,I.jsxs)("button",{className:"btn btn-primary",type:"submit",disabled:e.loading,children:[(0,I.jsx)(L.Z,{loading:e.loading,iconClass:"fas fa-search"}),(0,a.ag)("common.search")]}),(0,I.jsxs)("button",{className:"btn btn-light",type:"button",onClick:function(){Object.keys(ne).forEach((function(e){m.setValue(e,ne[e])})),n(N.Z.doReset()),l(!1)},disabled:e.loading,children:[(0,I.jsx)(L.Z,{loading:e.loading,iconClass:"fas fa-undo"}),(0,a.ag)("common.reset")]})]})})]})}))})})]})};var re=function(e){return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(r.Z,{children:[(0,I.jsx)(c.Z,{fluid:!0,children:(0,I.jsxs)(l.Z,{children:[(0,I.jsx)(i.Z,{xs:9,children:(0,I.jsx)(o.Z,{children:(0,a.ag)("entities.notification.list.title")})}),(0,I.jsx)(i.Z,{md:"auto",children:(0,I.jsx)(F,{})})]})}),(0,I.jsx)(ae,{}),(0,I.jsx)(K,{})]})})}},44587:function(e,t,n){var s=n(47313),a=n(1168),r=n(46417);t.Z=function(e){var t=(0,s.useRef)();(0,s.useEffect)((function(){window.$(t.current).modal("show"),window.$(t.current).on("hidden.bs.modal",e.onClose)}),[]);return a.createPortal((0,r.jsx)("div",{ref:t,className:"modal",tabIndex:-1,children:(0,r.jsx)("div",{className:"modal-dialog modal-sm",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h5",{className:"modal-title",children:e.title}),(0,r.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,r.jsx)("span",{children:"\xd7"})})]}),(0,r.jsxs)("div",{className:"modal-footer",children:[(0,r.jsx)("button",{type:"button",className:"btn btn-light btn-sm","data-dismiss":"modal",children:e.cancelText}),(0,r.jsx)("button",{type:"button",onClick:function(){return window.$(t.current).modal("hide"),e.onConfirm()},className:"btn btn-primary btn-sm",children:e.okText})]})]})})}),document.getElementById("modal-root"))}},68031:function(e,t,n){n.d(t,{Z:function(){return b}});var s=n(1413),a=n(42982),r=n(70885),o=n(47313),c=n(74773),l=n(74165),i=n(15861),d=n(1168),u=n(10499),m=n(89333),h=n(33512),f=n(46417);var x=function(e){var t=(0,o.useRef)(),n=(0,o.useState)(!1),s=(0,r.Z)(n,2),a=s[0],x=s[1];(0,o.useEffect)((function(){window.$(t.current).modal("show"),window.$(t.current).on("hidden.bs.modal",e.onClose)}),[]);var Z=function(){var n=(0,i.Z)((0,l.Z)().mark((function n(s,a){var r,o;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,x(!0),n.next=4,c.Z.create(a);case 4:return n.next=6,c.Z.fetchUsers({email:a.emails[0]},null,1,0);case 6:r=n.sent,o=r.rows,window.$(t.current).modal("hide"),e.onSuccess(o[0]),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),h.Z.handle(n.t0);case 15:return n.prev=15,x(!1),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[0,12,15,18]])})));return function(e,t){return n.apply(this,arguments)}}();return d.createPortal((0,f.jsx)("div",{ref:t,className:"modal",tabIndex:-1,children:(0,f.jsx)("div",{className:"modal-dialog modal-lg",children:(0,f.jsxs)("div",{className:"modal-content",children:[(0,f.jsxs)("div",{className:"modal-header",children:[(0,f.jsx)("h5",{className:"modal-title",children:(0,u.ag)("user.new.titleModal")}),(0,f.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,f.jsx)("span",{children:"\xd7"})})]}),(0,f.jsx)("div",{className:"modal-body",children:(0,f.jsx)(m.Z,{saveLoading:a,onSubmit:Z,onCancel:function(){window.$(t.current).modal("hide")},modal:!0,single:!0})})]})})}),document.getElementById("modal-root"))},Z=n(49513),p=n(43270),v=n(45788),j=n(15021);var b=function(e){var t=(0,p.Gc)(),n=t.setValue,l=t.getValues,i=(0,o.useState)(!1),d=(0,r.Z)(i,2),u=d[0],m=d[1],h=(0,v.v9)(j.Z.selectPermissionToCreate);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Z.Z,(0,s.Z)((0,s.Z)({},e),{},{fetchFn:function(e,t){return c.Z.fetchUserAutocomplete(e,t)},mapper:{toAutocomplete:function(e){if(!e)return null;if(e.fullName||e.email){var t=e.email;return e.fullName&&(t="".concat(e.fullName," <").concat(e.email,">")),{value:e.id,label:t}}return{value:e.id,label:e.label}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){return m(!0)},hasPermissionToCreate:h})),u&&(0,f.jsx)(x,{visible:u,onClose:function(){return m(!1)},onSuccess:function(t){var s=e.name,r=e.mode;n(s,r&&"multiple"===r?[].concat((0,a.Z)(l()[s]||[]),[t]):t),m(!1)}})]})}},1296:function(e,t,n){n(47313);var s=n(28303),a=n(45788),r=n(15021),o=n(46417);t.Z=function(e){var t=(0,a.v9)(r.Z.selectPermissionToRead),n=function(){var t=e.value;return t?Array.isArray(t)?t:[t]:[]},c=function(e){return e?e.fullName?"".concat(e.fullName," <").concat(e.email,">"):e.email:null};return n().length?(0,o.jsx)(o.Fragment,{children:n().map((function(e){return n=e,t?(0,o.jsx)("div",{children:(0,o.jsx)(s.rU,{className:"btn btn-link",to:"/user/".concat(n.id),children:c(n)})},n.id):(0,o.jsx)("div",{children:c(n)},n.id);var n}))}):null}},22102:function(e,t,n){var s=n(1413),a=n(45987),r=n(46123),o=n.n(r),c=n(47313),l=n(68524),i=n(46417),d=["bsPrefix","fluid","as","className"],u=c.forwardRef((function(e,t){var n=e.bsPrefix,r=e.fluid,c=void 0!==r&&r,u=e.as,m=void 0===u?"div":u,h=e.className,f=(0,a.Z)(e,d),x=(0,l.vE)(n,"container"),Z="string"===typeof c?"-".concat(c):"-fluid";return(0,i.jsx)(m,(0,s.Z)((0,s.Z)({ref:t},f),{},{className:o()(h,c?"".concat(x).concat(Z):x)}))}));u.displayName="Container",t.Z=u}}]);