"use strict";(self.webpackChunkapp_frontend=self.webpackChunkapp_frontend||[]).push([[1107],{6891:function(n,e,r){r.d(e,{Z:function(){return h}});var t=r(70885),a=r(74165),i=r(15861),o=r(15671),l=r(43144),u=r(99811),s=r.n(u),c=r(10499),m=r(63922),d=r(95162),f=r(81384),p=r(31881),x=r.n(p),h=function(){function n(){(0,o.Z)(this,n)}return(0,l.Z)(n,null,[{key:"validate",value:function(n,e){if(e){if(e.image&&!n.type.startsWith("image"))throw new Error((0,c.ag)("fileUploader.image"));if(e.storage.maxSizeInBytes&&n.size>e.storage.maxSizeInBytes)throw new Error((0,c.ag)("fileUploader.size",s()(e.storage.maxSizeInBytes)));var r=g(n.name);if(e.formats&&!e.formats.includes(r))throw new Error((0,c.ag)("fileUploader.formats",e.formats.join(", ")))}}},{key:"upload",value:function(){var n=(0,i.Z)((0,a.Z)().mark((function n(e,r){var t,i,o,l,u,s,c;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0,this.validate(e,r),n.next=7;break;case 4:return n.prev=4,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 7:return t=g(e.name),i=(0,d.Z)(),o="".concat(i,".").concat(t),n.next=12,this.fetchFileCredentials(o,r);case 12:return l=n.sent,u=l.uploadCredentials,s=l.downloadUrl,c=l.privateUrl,n.next=18,this.uploadToServer(e,u);case 18:return n.abrupt("return",{id:i,name:e.name,sizeInBytes:e.size,publicUrl:u&&u.publicUrl?u.publicUrl:null,privateUrl:c,downloadUrl:s,new:!0});case 19:case"end":return n.stop()}}),n,this,[[0,4]])})));return function(e,r){return n.apply(this,arguments)}}()},{key:"fetchFileCredentials",value:function(){var n=(0,i.Z)((0,a.Z)().mark((function n(e,r){var t,i,o;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=f.Z.get(),n.next=3,m.Z.get("/tenant/".concat(t,"/file/credentials"),{params:{filename:e,storageId:r.storage.id}});case 3:return i=n.sent,o=i.data,n.abrupt("return",o);case 6:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}()},{key:"uploadToServer",value:function(){var n=(0,i.Z)((0,a.Z)().mark((function n(e,r){var i,o,l,u,s,c,m;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(n.prev=0,i=r.url,o=new FormData,l=0,u=Object.entries(r.fields||{});l<u.length;l++)s=(0,t.Z)(u[l],2),c=s[0],m=s[1],o.append(c,m);return o.append("file",e),n.abrupt("return",x().post(i,o,{headers:{"Content-Type":"multipart/form-data"}}));case 8:throw n.prev=8,n.t0=n.catch(0),console.error(n.t0),n.t0;case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,r){return n.apply(this,arguments)}}()}]),n}();function g(n){if(!n)return null;var e=/(?:\.([^.]+))?$/.exec(n);return e?e[1]:null}},89994:function(n,e,r){var t=r(42982),a=r(3463),i=r(10499),o=r(70816),l=r.n(o),u={generic:function(n){return a.nK().label(n)},string:function(n,e){e=e||{};var r=a.Z_().transform((function(n,e){return""===e?null:n})).nullable(!0).trim().label(n);return e.required&&(r=r.required()),(e.min||0===e.min)&&(r=r.min(e.min)),e.max&&(r=r.max(e.max)),e.matches&&(r=r.matches(e.matches)),r},boolean:function(n,e){return a.Xg().default(!1).label(n)},relationToOne:function(n,e){e=e||{};var r=a.nK().nullable(!0).label(n).transform((function(n,e){return e?e.id:null}));return e.required&&(r=r.required()),r},stringArray:function(n,e){e=e||{};var r=a.IX().compact().ensure().of(a.Z_().transform((function(n,e){return""===e?null:n})).trim()).label(n);return(e.required||e.min)&&(r=r.required()),e.min||0===e.min?r=r.min(e.min):e.required&&(r=r.min(1)),e.max&&(r=r.max(e.max)),r},relationToMany:function(n,e){e=e||{};var r=a.IX().nullable(!0).label(n).transform((function(n,e){return e&&e.length?e.map((function(n){return n.id})):[]}));return(e.required||e.min)&&(r=r.required()),e.min||0===e.min?r=r.min(e.min):e.required&&(r=r.min(1)),e.max&&(r=r.max(e.max)),r},integer:function(n,e){e=e||{};var r=a.Rx().transform((function(n,e){return""===e?null:n})).integer().nullable(!0).label(n);return e.required&&(r=r.required()),(e.min||0===e.min)&&(r=r.min(e.min)),e.max&&(r=r.max(e.max)),r},images:function(n,e){e=e||{};var r=a.IX().nullable(!0).label(n);return(e.required||e.min)&&(r=r.required()),e.min||0===e.min?r=r.min(e.min):e.required&&(r=r.min(1)),e.max&&(r=r.max(e.max)),r},files:function(n,e){e=e||{};var r=a.IX().compact().ensure().nullable(!0).label(n);return(e.required||e.min)&&(r=r.required()),e.min||0===e.min?r=r.min(e.min):e.required&&(r=r.min(1)),e.max&&(r=r.max(e.max)),r},enumerator:function(n,e){e=e||{};var r=a.Z_().transform((function(n,e){return""===e?null:n})).label(n).nullable(!0).oneOf([null].concat((0,t.Z)(e.options||[])));return e.required&&(r=r.required((0,i.ag)("validation.string.selected"))),r},email:function(n,e){e=e||{};var r=a.Z_().transform((function(n,e){return""===e?null:n})).nullable(!0).trim().label(n).email();return e.required&&(r=r.required()),(e.min||0===e.min)&&(r=r.min(e.min)),e.max&&(r=r.max(e.max)),e.matches&&(r=r.matches(e.matches)),r},decimal:function(n,e){e=e||{};var r=a.Rx().transform((function(n,e){return""===e?null:n})).nullable(!0).label(n);return e.required&&(r=r.required()),(e.min||0===e.min)&&(r=r.min(e.min)),e.max&&(r=r.max(e.max)),r},datetime:function(n,e){e=e||{};var r=a.nK().nullable(!0).label(n).transform((function(n,e){return n?l()(e,"YYYY-MM-DD HH:mm").toISOString():null}));return e.required&&(r=r.required()),r},date:function(n,e){e=e||{};var r=a.nK().nullable(!0).label(n).test("is-date",(0,i.ag)("validation.mixed.default"),(function(n){return!n||l()(n,"YYYY-MM-DD").isValid()})).transform((function(n){return n?l()(n).format("YYYY-MM-DD"):null}));return e.required&&(r=r.required()),r}};e.Z=u},95748:function(n,e,r){r(47313);var t=r(46417);e.Z=function(n){return n.loading?(0,t.jsx)("span",{className:"spinner-border spinner-border-sm"}):n.iconClass?(0,t.jsx)("i",{className:n.iconClass}):null}},49384:function(n,e,r){r.d(e,{Z:function(){return i}});var t=r(15671),a=r(43144),i=function(){function n(){(0,t.Z)(this,n)}return(0,a.Z)(n,null,[{key:"errorMessage",value:function(n,e,r,t){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(i)return i;if(!t&&!r[n])return null;var o=e[n];return(null===o||void 0===o||null===(a=o[0])||void 0===a?void 0:a.message)||(null===o||void 0===o?void 0:o.message)||o||null}}]),n}()},85543:function(n,e,r){var t=r(47313),a=r(89722),i=r(43270),o=r(49384),l=r(46417);function u(n){var e=n.label,r=n.name,u=n.hint,s=n.storage,c=n.max,m=n.required,d=n.externalErrorMessage,f=(0,i.Gc)(),p=f.errors,x=f.formState,h=x.touched,g=x.isSubmitted,b=f.setValue,v=f.watch,Z=f.register;(0,t.useEffect)((function(){Z({name:r})}),[Z,r]);var w=o.Z.errorMessage(r,p,h,g,d);return(0,l.jsxs)("div",{className:"form-group",children:[Boolean(e)&&(0,l.jsx)("label",{className:"col-form-label ".concat(m?"required":null),htmlFor:r,children:e}),(0,l.jsx)("br",{}),(0,l.jsx)(a.Z,{storage:s,value:v(r),onChange:function(e){b(r,e,{shouldValidate:!0,shouldDirty:!0}),n.onChange&&n.onChange(e)},max:c}),(0,l.jsx)("div",{className:"invalid-feedback",children:w}),Boolean(u)&&(0,l.jsx)("small",{className:"form-text text-muted",children:u})]})}u.defaultProps={max:void 0,required:!1},e.Z=u},68160:function(n,e,r){var t,a=r(30168),i=r(38269).ZP.div(t||(t=(0,a.Z)(["\n  padding-top: 0;\n  padding-bottom: 0;\n\n  label.required::before {\n    display: inline-block;\n    margin-right: 4px;\n    content: '*';\n    line-height: 1;\n    font-size: 13px;\n    color: #f5222d;\n  }\n  .app__specification {\n    padding: 14px;\n  }\n  .react-datepicker-wrapper {\n    width: 100%;\n  }\n  i {\n    padding-right: 4px;\n    font-size: 14px;\n  }\n  .adherent-control {\n    z-index: 0;\n  }\n\n  .invalid-feedback {\n    display: block;\n  }\n\n  .form-buttons {\n    padding-top: 16px;\n\n    .btn {\n      margin-right: 8px;\n      margin-bottom: 8px;\n    }\n  }\n"])));e.Z=i},89722:function(n,e,r){r.d(e,{Z:function(){return Z}});var t,a,i=r(74165),o=r(42982),l=r(15861),u=r(70885),s=r(47313),c=r(6891),m=r(33512),d=r(10499),f=r(30168),p=r(38269),x=p.ZP.div(t||(t=(0,f.Z)(["\n  .img-card:hover .img-buttons {\n    display: block;\n  }\n\n  .img-buttons {\n    display: none;\n    position: relative;\n    bottom: 2.1rem;\n    width: calc(100px);\n    text-align: center;\n    background-color: rgba(0, 0, 0, 0.5);\n  }\n\n  .img-buttons * {\n    color: white;\n  }\n"]))),h=r(46417),g=p.ZP.div(a||(a=(0,f.Z)(["\n  /* The Modal (background) */\n  .modal {\n    display: block;\n    position: fixed; /* Stay in place */\n    z-index: 9999; /* Sit on top */\n    padding-top: 100px; /* Location of the box */\n    left: 0;\n    top: 0;\n    width: 100%; /* Full width */\n    height: 100%; /* Full height */\n    overflow: auto; /* Enable scroll if needed */\n    background-color: rgb(0, 0, 0); /* Fallback color */\n    background-color: rgba(\n      0,\n      0,\n      0,\n      0.9\n    ); /* Black w/ opacity */\n  }\n\n  /* Modal Content (Image) */\n  .modal-content {\n    margin: auto;\n    display: block;\n    width: 80%;\n    max-width: 700px;\n  }\n\n  /* Caption of Modal Image (Image Text) - Same Width as the Image */\n  #caption {\n    margin: auto;\n    display: block;\n    width: 80%;\n    max-width: 700px;\n    text-align: center;\n    color: #ccc;\n    padding: 10px 0;\n    height: 150px;\n  }\n\n  /* Add Animation - Zoom in the Modal */\n  .modal-content,\n  #caption {\n    animation-name: zoom;\n    animation-duration: 0.6s;\n  }\n\n  @keyframes zoom {\n    from {\n      transform: scale(0);\n    }\n    to {\n      transform: scale(1);\n    }\n  }\n\n  /* The Close Button */\n  .close {\n    position: absolute;\n    top: 15px;\n    right: 35px;\n    color: #f1f1f1;\n    font-size: 40px;\n    font-weight: bold;\n    transition: 0.3s;\n  }\n\n  .close:hover,\n  .close:focus {\n    color: #bbb;\n    text-decoration: none;\n    cursor: pointer;\n  }\n\n  /* 100% Image Width on Smaller Screens */\n  @media only screen and (max-width: 700px) {\n    .modal-content {\n      width: 100%;\n    }\n  }\n"])));var b=function(n){return(0,h.jsx)(g,{children:(0,h.jsxs)("div",{className:"modal",children:[(0,h.jsx)("span",{className:"close",onClick:n.onClose,children:"\xd7"}),(0,h.jsx)("img",{className:"modal-content",src:n.src,alt:n.alt})]})})},v=r(95748);var Z=function(n){var e=(0,s.useState)(!1),r=(0,u.Z)(e,2),t=r[0],a=r[1],f=(0,s.useState)(null),p=(0,u.Z)(f,2),g=p[0],Z=p[1],w=(0,s.useRef)(),y=function(){var e=n.value;return e?Array.isArray(e)?e:[e]:[]},k=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(r){var t,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(t=r.target.files)&&t.length){e.next=4;break}return e.abrupt("return");case 4:return l=t[0],c.Z.validate(l,{storage:n.storage,image:!0}),a(!0),e.next=9,c.Z.upload(l,{storage:n.storage,image:!0});case 9:l=e.sent,w.current.value="",a(!1),n.onChange([].concat((0,o.Z)(y()),[l])),e.next=21;break;case 15:e.prev=15,e.t0=e.catch(0),w.current.value="",console.error(e.t0),a(!1),m.Z.showMessage(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(n){return e.apply(this,arguments)}}(),q=n.max,j=n.readonly,C=(0,h.jsxs)("label",{className:"btn btn-outline-secondary px-4 mb-2",style:{cursor:"pointer"},children:[(0,h.jsx)(v.Z,{loading:t,iconClass:"fas fa-plus"}),(0,d.ag)("fileUploader.upload"),(0,h.jsx)("input",{style:{display:"none"},disabled:t||j,accept:"image/*",type:"file",onChange:k,ref:w})]});return(0,h.jsxs)(x,{children:[j||q&&y().map((function(n){return{uid:n.id||void 0,name:n.name,status:"done",url:n.downloadUrl}})).length>=q?null:C,y()&&y().length?(0,h.jsx)("div",{className:"d-flex flex-row flex-wrap",children:y().map((function(e){return(0,h.jsxs)("div",{className:"mr-2 mb-2 img-card",style:{height:"100px"},children:[(0,h.jsx)("img",{alt:e.name,src:e.downloadUrl,className:"img-thumbnail",style:{width:"100px",height:"100px",objectFit:"cover"}}),(0,h.jsxs)("div",{className:"img-buttons rounded-bottom",children:[(0,h.jsx)("button",{type:"button",className:"btn btn-link",onClick:function(){return function(n){Z({src:n.downloadUrl,alt:n.name})}(e)},children:(0,h.jsx)("i",{className:"fas fa-search"})}),!j&&(0,h.jsx)("button",{type:"button",className:"btn btn-link ml-2",onClick:function(){return r=e.id,void n.onChange(y().filter((function(n){return n.id!==r})));var r},children:(0,h.jsx)("i",{className:"fas fa-times"})})]})]},e.id)}))}):null,g&&(0,h.jsx)(b,{src:g.src,alt:g.alt,onClose:function(){Z(null)}})]})}}}]);