"use strict";(self.webpackChunkapp_frontend=self.webpackChunkapp_frontend||[]).push([[4280],{67922:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(74165),a=n(15861),s=n(15671),i=n(43144),c=n(63922),o=n(81384),u=function(){function e(){(0,s.Z)(this,e)}return(0,i.Z)(e,null,[{key:"update",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,s,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t,data:n},s=o.Z.get(),e.next=4,c.Z.put("/tenant/".concat(s,"/spot/").concat(t),a);case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"destroyAll",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={ids:t},a=o.Z.get(),e.next=4,c.Z.delete("/tenant/".concat(a,"/spot"),{params:n});case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={data:t},a=o.Z.get(),e.next=4,c.Z.post("/tenant/".concat(a,"/spot"),n);case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"import",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,s,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={data:t,importHash:n},s=o.Z.get(),e.next=4,c.Z.post("/tenant/".concat(s,"/spot/import"),a);case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.Z.get(),e.next=3,c.Z.get("/tenant/".concat(n,"/spot/").concat(t));case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"list",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,a,s){var i,u,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={filter:t,orderBy:n,limit:a,offset:s},u=o.Z.get(),e.next=4,c.Z.get("/tenant/".concat(u,"/spot"),{params:i});case 4:return l=e.sent,e.abrupt("return",l.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"listAutocomplete",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,s,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={query:t,limit:n},s=o.Z.get(),e.next=4,c.Z.get("/tenant/".concat(s,"/spot/autocomplete"),{params:a});case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()},15021:function(e,t,n){var r=n(76747),a=n(86495),s=n(26319),i=n(71945),c=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(i.Z.values.userRead)})),o=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(i.Z.values.userEdit)})),u=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(i.Z.values.userDestroy)})),l={selectPermissionToRead:c,selectPermissionToEdit:o,selectPermissionToCreate:(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(i.Z.values.userCreate)})),selectPermissionToImport:(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(i.Z.values.userImport)})),selectPermissionToDestroy:u};t.Z=l},61567:function(e,t,n){n(47313);var r=n(46417);t.Z=function(){return(0,r.jsx)("div",{style:{width:"100%",marginTop:"24px",marginBottom:"24px",display:"flex",justifyContent:"center",alignContent:"center",alignItems:"center"},children:(0,r.jsx)("div",{className:"spinner-border text-primary"})})}},14280:function(e,t,n){n.r(t),n.d(t,{default:function(){return L}});var r=n(70885),a=n(47313),s=n(45788),i=n(63830),c=n(10499),o=n(74165),u=n(15861),l=n(67922),d=n(33512),p=n(14122),m=n(40476),f="COUPONS_FORM",Z={INIT_STARTED:"".concat(f,"_INIT_STARTED"),INIT_SUCCESS:"".concat(f,"_INIT_SUCCESS"),INIT_ERROR:"".concat(f,"_INIT_ERROR"),CREATE_STARTED:"".concat(f,"_CREATE_STARTED"),CREATE_SUCCESS:"".concat(f,"_CREATE_SUCCESS"),CREATE_ERROR:"".concat(f,"_CREATE_ERROR"),UPDATE_STARTED:"".concat(f,"_UPDATE_STARTED"),UPDATE_SUCCESS:"".concat(f,"_UPDATE_SUCCESS"),UPDATE_ERROR:"".concat(f,"_UPDATE_ERROR"),doInit:function(e){return function(){var t=(0,u.Z)((0,o.Z)().mark((function t(n){var r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n({type:Z.INIT_STARTED}),r={},!Boolean(e)){t.next=8;break}return t.next=7,l.Z.find(e);case 7:r=t.sent;case 8:n({type:Z.INIT_SUCCESS,payload:r}),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),d.Z.handle(t.t0),n({type:Z.INIT_ERROR}),(0,m.s1)().push("/spot");case 16:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},doCreate:function(e){return function(){var t=(0,u.Z)((0,o.Z)().mark((function t(n){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:Z.CREATE_STARTED}),t.next=4,l.Z.create(e);case 4:n({type:Z.CREATE_SUCCESS}),p.Z.success((0,c.ag)("entities.vip.create.success")),(0,m.s1)().push("/spot"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),d.Z.handle(t.t0),n({type:Z.CREATE_ERROR});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},doUpdate:function(e,t){return function(){var n=(0,u.Z)((0,o.Z)().mark((function n(r,a){return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r({type:Z.UPDATE_STARTED}),n.next=4,l.Z.update(e,t);case 4:r({type:Z.UPDATE_SUCCESS}),p.Z.success((0,c.ag)("entities.vip.update.success")),(0,m.s1)().push("/spot"),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),d.Z.handle(n.t0),r({type:Z.UPDATE_ERROR});case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()}},v=Z,g=n(76747),h=function(e){return e.vip.form},T=(0,g.P1)([h],(function(e){return e.record})),x={selectInitLoading:(0,g.P1)([h],(function(e){return Boolean(e.initLoading)})),selectSaveLoading:(0,g.P1)([h],(function(e){return Boolean(e.saveLoading)})),selectRecord:T,selectRaw:h},y=n(1413),E=n(43270),b=n(89994),C=n(95748),S=n(68160),R=n(3463),w=n(67357),j=n(47575),P=n(68031),_=n(5544),A=n(46417),k=R.Ry().shape({orderNo:b.Z.string((0,c.ag)("entities.spot.fields.orderNo"),{required:!0}),orderType:b.Z.enumerator((0,c.ag)("entities.spot.fields.orderType"),{options:["type","market"],required:!0}),userAccount:b.Z.relationToOne((0,c.ag)("entities.spot.fields.userAccount"),{required:!0}),tradingPair:b.Z.string((0,c.ag)("entities.spot.fields.tradingPair"),{required:!0}),direction:b.Z.enumerator((0,c.ag)("entities.spot.fields.direction"),{options:["BUY","SELL"],required:!0}),delegateType:b.Z.string((0,c.ag)("entities.spot.fields.delegateType"),{required:!0}),delegateState:b.Z.string((0,c.ag)("entities.spot.fields.delegateState"),{required:!0}),orderQuantity:b.Z.decimal((0,c.ag)("entities.spot.fields.orderQuantity"),{required:!0}),commissionPrice:b.Z.decimal((0,c.ag)("entities.spot.fields.commissionPrice"),{required:!0}),entrustedValue:b.Z.decimal((0,c.ag)("entities.spot.fields.entrustedValue"),{required:!0}),transactionQuantity:b.Z.decimal((0,c.ag)("entities.spot.fields.transactionQuantity")),transactionValue:b.Z.decimal((0,c.ag)("entities.spot.fields.transactionValue")),closingPrice:b.Z.decimal((0,c.ag)("entities.spot.fields.closingPrice")),handlingFee:b.Z.decimal((0,c.ag)("entities.spot.fields.handlingFee")),commissionTime:b.Z.datetime((0,c.ag)("entities.spot.fields.commissionTime")),closingTime:b.Z.datetime((0,c.ag)("entities.spot.fields.closingTime")),status:b.Z.enumerator((0,c.ag)("entities.spot.fields.status"),{options:["pending","completed","canceled"],required:!0})});var N=function(e){var t=(0,a.useState)((function(){var t=e.record||{};return{orderNo:t.orderNo,orderType:t.orderType,userAccount:t.userAccount,tradingPair:t.tradingPair,direction:t.direction,delegateType:t.delegateType,delegateState:t.delegateState,orderQuantity:t.orderQuantity,commissionPrice:t.commissionPrice,entrustedValue:t.entrustedValue,transactionQuantity:t.transactionQuantity,transactionValue:t.transactionValue,closingPrice:t.closingPrice,handlingFee:t.handlingFee,commissionTime:t.commissionTime,closingTime:t.closingTime,status:t.status||"OPEN"}})),n=(0,r.Z)(t,1)[0],s=(0,E.cI)({resolver:(0,w.X)(k),mode:"all",defaultValues:n}),i=function(t){var n;e.onSubmit(null===(n=e.record)||void 0===n?void 0:n.id,t)};return(0,A.jsx)(S.Z,{children:(0,A.jsx)(E.RV,(0,y.Z)((0,y.Z)({},s),{},{children:(0,A.jsxs)("form",{onSubmit:s.handleSubmit(i),children:[(0,A.jsx)("div",{className:"row g-3",children:Object.keys(n).map((function(e){return(0,A.jsx)("div",{className:"col-lg-6 col-md-6 col-sm-12",children:"userAccount"===e?(0,A.jsx)(P.Z,{name:e,label:(0,c.ag)("entities.spot.fields.".concat(e))}):"direction"===e?(0,A.jsx)(_.Z,{name:e,label:(0,c.ag)("entities.spot.fields.".concat(e)),options:["BUY","SELL"].map((function(e){return{value:e,label:e}}))}):"orderType"===e?(0,A.jsx)(_.Z,{name:e,label:(0,c.ag)("entities.spot.fields.".concat(e)),options:["type","market"].map((function(e){return{value:e,label:e}}))}):"status"===e?(0,A.jsx)(_.Z,{name:e,label:(0,c.ag)("entities.spot.fields.".concat(e)),options:["pending","completed","canceled"].map((function(e){return{value:e,label:e}}))}):e.includes("Time")?(0,A.jsx)(j.Z,{name:e,label:(0,c.ag)("entities.spot.fields.".concat(e)),type:"datetime-local"}):e.includes("Price")||e.includes("Quantity")||e.includes("Value")||e.includes("Fee")?(0,A.jsx)(j.Z,{name:e,label:(0,c.ag)("entities.spot.fields.".concat(e)),type:"number"}):(0,A.jsx)(j.Z,{name:e,label:(0,c.ag)("entities.spot.fields.".concat(e))})},e)}))}),(0,A.jsxs)("div",{className:"form-buttons d-flex flex-wrap gap-2 mt-3",children:[(0,A.jsxs)("button",{className:"btn btn-primary",disabled:e.saveLoading,type:"button",onClick:s.handleSubmit(i),children:[(0,A.jsx)(C.Z,{loading:e.saveLoading,iconClass:"far fa-save"}),"\xa0",(0,c.ag)("common.save")]}),(0,A.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){Object.keys(n).forEach((function(e){return s.setValue(e,n[e])}))},children:[(0,A.jsx)("i",{className:"fas fa-undo"}),"\xa0",(0,c.ag)("common.reset")]}),e.onCancel&&(0,A.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:e.onCancel,children:[(0,A.jsx)("i",{className:"fas fa-times"}),"\xa0",(0,c.ag)("common.cancel")]})]})]})}))})},U=n(27829),I=n(61567),D=n(75352);var L=function(e){var t=(0,a.useState)(!1),n=(0,r.Z)(t,2),o=n[0],u=n[1],l=(0,s.I0)(),d=(0,i.$B)(),p=(0,s.v9)(x.selectInitLoading),f=(0,s.v9)(x.selectSaveLoading),Z=(0,s.v9)(x.selectRecord),g=Boolean(d.params.id),h=g?(0,c.ag)("entities.spot.edit.title"):(0,c.ag)("entities.spot.new.title");return(0,a.useEffect)((function(){l(v.doInit(d.params.id)),u(!0)}),[l,d.params.id]),(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(U.Z,{children:[(0,A.jsx)(D.Z,{children:h}),p&&(0,A.jsx)(I.Z,{}),o&&!p&&(0,A.jsx)(N,{saveLoading:f,initLoading:p,record:Z,isEditing:g,onSubmit:function(e,t){l(g?v.doUpdate(e,t):v.doCreate(t))},onCancel:function(){return(0,m.s1)().push("/spot")}})]})})}},68031:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(1413),a=n(42982),s=n(70885),i=n(47313),c=n(74773),o=n(74165),u=n(15861),l=n(1168),d=n(10499),p=n(89333),m=n(33512),f=n(46417);var Z=function(e){var t=(0,i.useRef)(),n=(0,i.useState)(!1),r=(0,s.Z)(n,2),a=r[0],Z=r[1];(0,i.useEffect)((function(){window.$(t.current).modal("show"),window.$(t.current).on("hidden.bs.modal",e.onClose)}),[]);var v=function(){var n=(0,u.Z)((0,o.Z)().mark((function n(r,a){var s,i;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,Z(!0),n.next=4,c.Z.create(a);case 4:return n.next=6,c.Z.fetchUsers({email:a.emails[0]},null,1,0);case 6:s=n.sent,i=s.rows,window.$(t.current).modal("hide"),e.onSuccess(i[0]),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),m.Z.handle(n.t0);case 15:return n.prev=15,Z(!1),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[0,12,15,18]])})));return function(e,t){return n.apply(this,arguments)}}();return l.createPortal((0,f.jsx)("div",{ref:t,className:"modal",tabIndex:-1,children:(0,f.jsx)("div",{className:"modal-dialog modal-lg",children:(0,f.jsxs)("div",{className:"modal-content",children:[(0,f.jsxs)("div",{className:"modal-header",children:[(0,f.jsx)("h5",{className:"modal-title",children:(0,d.ag)("user.new.titleModal")}),(0,f.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,f.jsx)("span",{children:"\xd7"})})]}),(0,f.jsx)("div",{className:"modal-body",children:(0,f.jsx)(p.Z,{saveLoading:a,onSubmit:v,onCancel:function(){window.$(t.current).modal("hide")},modal:!0,single:!0})})]})})}),document.getElementById("modal-root"))},v=n(49513),g=n(43270),h=n(45788),T=n(15021);var x=function(e){var t=(0,g.Gc)(),n=t.setValue,o=t.getValues,u=(0,i.useState)(!1),l=(0,s.Z)(u,2),d=l[0],p=l[1],m=(0,h.v9)(T.Z.selectPermissionToCreate);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(v.Z,(0,r.Z)((0,r.Z)({},e),{},{fetchFn:function(e,t){return c.Z.fetchUserAutocomplete(e,t)},mapper:{toAutocomplete:function(e){if(!e)return null;if(e.fullName||e.email){var t=e.email;return e.fullName&&(t="".concat(e.fullName," <").concat(e.email,">")),{value:e.id,label:t}}return{value:e.id,label:e.label}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){return p(!0)},hasPermissionToCreate:m})),d&&(0,f.jsx)(Z,{visible:d,onClose:function(){return p(!1)},onSuccess:function(t){var r=e.name,s=e.mode;n(r,s&&"multiple"===s?[].concat((0,a.Z)(o()[r]||[]),[t]):t),p(!1)}})]})}}}]);