"use strict";(self.webpackChunkapp_frontend=self.webpackChunkapp_frontend||[]).push([[2943],{15021:function(e,t,n){var i=n(76747),a=n(86495),s=n(26319),r=n(71945),o=(0,i.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(r.Z.values.userRead)})),l=(0,i.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(r.Z.values.userEdit)})),c=(0,i.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(r.Z.values.userDestroy)})),u={selectPermissionToRead:o,selectPermissionToEdit:l,selectPermissionToCreate:(0,i.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(r.Z.values.userCreate)})),selectPermissionToImport:(0,i.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new s.Z(e,t).match(r.Z.values.userImport)})),selectPermissionToDestroy:c};t.Z=u},32943:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var i=n(70885),a=n(47313),s=n(45788),r=n(63830),o=n(10499),l=n(80040),c=n(76747),u=function(e){return e.notification.form},d=(0,c.P1)([u],(function(e){return e.record})),m={selectInitLoading:(0,c.P1)([u],(function(e){return Boolean(e.initLoading)})),selectSaveLoading:(0,c.P1)([u],(function(e){return Boolean(e.saveLoading)})),selectRecord:d,selectRaw:u},f=n(40476),v=n(1413),g=n(43270),p=n(89994),Z=n(95748),h=n(68160),b=n(3463),x=n(67357),j=n(47575),y=n(68031),w=n(5544),C=n(46417),N=b.Ry().shape({user:p.Z.relationToOne((0,o.ag)("entities.notification.fields.user"),{required:!1}),type:p.Z.enumerator((0,o.ag)("entities.notification.fields.type"),{options:["deposit","withdraw","staking","kyc","commission","futures","accountActivated","custom"],required:!0}),message:p.Z.string((0,o.ag)("entities.notification.fields.message"),{required:!0}),status:p.Z.enumerator((0,o.ag)("entities.notification.fields.status"),{options:["unread","read"],required:!0}),forAdmin:p.Z.boolean((0,o.ag)("entities.notification.fields.forAdmin")),createdBy:p.Z.relationToOne((0,o.ag)("entities.notification.fields.createdBy")),updatedBy:p.Z.relationToOne((0,o.ag)("entities.notification.fields.updatedBy"))});var k=function(e){var t=(0,a.useState)((function(){var t=e.record||{};return{userId:t.userId||null,type:t.type||"custom",message:t.message||"",status:t.status||"unread"}})),n=(0,i.Z)(t,1)[0],s=(0,g.cI)({resolver:(0,x.X)(N),mode:"all",defaultValues:n}),r=function(t){var n;t.userId=t.userId.id,e.onSubmit(null===(n=e.record)||void 0===n?void 0:n.id,t)};return(0,C.jsx)(h.Z,{children:(0,C.jsx)(g.RV,(0,v.Z)((0,v.Z)({},s),{},{children:(0,C.jsxs)("form",{onSubmit:s.handleSubmit(r),children:[(0,C.jsxs)("div",{className:"row",children:[(0,C.jsx)("div",{className:"col-lg-6 col-md-8 col-12",children:(0,C.jsx)(y.Z,{name:"userId",label:(0,o.ag)("entities.notification.fields.user")})}),(0,C.jsx)("div",{className:"col-lg-6 col-md-8 col-12",children:(0,C.jsx)(w.Z,{name:"type",label:(0,o.ag)("entities.notification.fields.type"),options:[{value:"deposit",label:(0,o.ag)("entities.notification.enumerators.type.deposit")},{value:"withdraw",label:(0,o.ag)("entities.notification.enumerators.type.withdraw")},{value:"staking",label:(0,o.ag)("entities.notification.enumerators.type.staking")},{value:"kyc",label:(0,o.ag)("entities.notification.enumerators.type.kyc")},{value:"commission",label:(0,o.ag)("entities.notification.enumerators.type.commission")},{value:"futures",label:(0,o.ag)("entities.notification.enumerators.type.futures")},{value:"accountActivated",label:(0,o.ag)("entities.notification.enumerators.type.accountActivated")},{value:"custom",label:(0,o.ag)("entities.notification.enumerators.type.custom")}],required:!0})}),(0,C.jsx)("div",{className:"col-12",children:(0,C.jsx)(j.Z,{name:"message",label:(0,o.ag)("entities.notification.fields.message"),required:!0})}),(0,C.jsx)("div",{className:"col-lg-6 col-md-8 col-12",children:(0,C.jsx)(w.Z,{name:"status",label:(0,o.ag)("entities.notification.fields.status"),options:[{value:"unread",label:(0,o.ag)("entities.notification.enumerators.status.unread")},{value:"read",label:(0,o.ag)("entities.notification.enumerators.status.read")}],required:!0})})]}),(0,C.jsxs)("div",{className:"form-buttons",children:[(0,C.jsxs)("button",{className:"btn btn-primary",disabled:e.saveLoading,type:"button",onClick:s.handleSubmit(r),children:[(0,C.jsx)(Z.Z,{loading:e.saveLoading,iconClass:"far fa-save"}),"\xa0",(0,o.ag)("common.save")]}),(0,C.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){Object.keys(n).forEach((function(e){s.setValue(e,n[e])}))},children:[(0,C.jsx)("i",{className:"fas fa-undo"}),"\xa0",(0,o.ag)("common.reset")]}),e.onCancel?(0,C.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){return e.onCancel()},children:[(0,C.jsx)("i",{className:"fas fa-times"}),"\xa0",(0,o.ag)("common.cancel")]}):null]})]})}))})},P=n(27829),T=n(61567),I=n(75352);var S=function(e){var t=(0,a.useState)(!1),n=(0,i.Z)(t,2),c=n[0],u=n[1],d=(0,s.I0)(),v=(0,r.$B)(),g=(0,s.v9)(m.selectInitLoading),p=(0,s.v9)(m.selectSaveLoading),Z=(0,s.v9)(m.selectRecord),h=Boolean(v.params.id),b=h?(0,o.ag)("entities.notification.edit.title"):(0,o.ag)("entities.notification.new.title");return(0,a.useEffect)((function(){d(l.Z.doInit(v.params.id)),u(!0)}),[d,v.params.id]),(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(P.Z,{children:[(0,C.jsx)(I.Z,{children:b}),g&&(0,C.jsx)(T.Z,{}),c&&!g&&(0,C.jsx)(k,{saveLoading:p,initLoading:g,record:Z,isEditing:h,onSubmit:function(e,t){d(h?l.Z.doUpdate(e,t):l.Z.doCreate(t))},onCancel:function(){return(0,f.s1)().push("/notification")}})]})})}},61567:function(e,t,n){n(47313);var i=n(46417);t.Z=function(){return(0,i.jsx)("div",{style:{width:"100%",marginTop:"24px",marginBottom:"24px",display:"flex",justifyContent:"center",alignContent:"center",alignItems:"center"},children:(0,i.jsx)("div",{className:"spinner-border text-primary"})})}},68031:function(e,t,n){n.d(t,{Z:function(){return x}});var i=n(1413),a=n(42982),s=n(70885),r=n(47313),o=n(74773),l=n(74165),c=n(15861),u=n(1168),d=n(10499),m=n(89333),f=n(33512),v=n(46417);var g=function(e){var t=(0,r.useRef)(),n=(0,r.useState)(!1),i=(0,s.Z)(n,2),a=i[0],g=i[1];(0,r.useEffect)((function(){window.$(t.current).modal("show"),window.$(t.current).on("hidden.bs.modal",e.onClose)}),[]);var p=function(){var n=(0,c.Z)((0,l.Z)().mark((function n(i,a){var s,r;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,g(!0),n.next=4,o.Z.create(a);case 4:return n.next=6,o.Z.fetchUsers({email:a.emails[0]},null,1,0);case 6:s=n.sent,r=s.rows,window.$(t.current).modal("hide"),e.onSuccess(r[0]),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),f.Z.handle(n.t0);case 15:return n.prev=15,g(!1),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[0,12,15,18]])})));return function(e,t){return n.apply(this,arguments)}}();return u.createPortal((0,v.jsx)("div",{ref:t,className:"modal",tabIndex:-1,children:(0,v.jsx)("div",{className:"modal-dialog modal-lg",children:(0,v.jsxs)("div",{className:"modal-content",children:[(0,v.jsxs)("div",{className:"modal-header",children:[(0,v.jsx)("h5",{className:"modal-title",children:(0,d.ag)("user.new.titleModal")}),(0,v.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,v.jsx)("span",{children:"\xd7"})})]}),(0,v.jsx)("div",{className:"modal-body",children:(0,v.jsx)(m.Z,{saveLoading:a,onSubmit:p,onCancel:function(){window.$(t.current).modal("hide")},modal:!0,single:!0})})]})})}),document.getElementById("modal-root"))},p=n(49513),Z=n(43270),h=n(45788),b=n(15021);var x=function(e){var t=(0,Z.Gc)(),n=t.setValue,l=t.getValues,c=(0,r.useState)(!1),u=(0,s.Z)(c,2),d=u[0],m=u[1],f=(0,h.v9)(b.Z.selectPermissionToCreate);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(p.Z,(0,i.Z)((0,i.Z)({},e),{},{fetchFn:function(e,t){return o.Z.fetchUserAutocomplete(e,t)},mapper:{toAutocomplete:function(e){if(!e)return null;if(e.fullName||e.email){var t=e.email;return e.fullName&&(t="".concat(e.fullName," <").concat(e.email,">")),{value:e.id,label:t}}return{value:e.id,label:e.label}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){return m(!0)},hasPermissionToCreate:f})),d&&(0,v.jsx)(g,{visible:d,onClose:function(){return m(!1)},onSuccess:function(t){var i=e.name,s=e.mode;n(i,s&&"multiple"===s?[].concat((0,a.Z)(l()[i]||[]),[t]):t),m(!1)}})]})}}}]);