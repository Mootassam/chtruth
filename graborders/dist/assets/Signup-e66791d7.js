import{M as k,u as x,f,h as s,I as M,J as a,T as A,O as I,U as N,j as e,L as j}from"./index-6ebcf233.js";import{a as o,u as T,y as q,F as R}from"./FormErrors-1e75c807.js";import{I as t}from"./InputFormItem-df339a5d.js";import{B}from"./ButtonIcon-8013cdfa.js";import{u as F}from"./useDispatch-2c14625a.js";function D(){const i=F(),p=k(),d=x(f.selectLoading),m=x(f.selectErrorMessage),[u,b]=s.useState(!1),[h,C]=s.useState("");s.useEffect(()=>{w()},[]);const g=M().shape({email:o.string(a("user.fields.username"),{required:!0}),password:o.string(a("user.fields.password"),{required:!0,min:8}),newPasswordConfirmation:o.string(a("user.fields.newPasswordConfirmation"),{required:!0}).oneOf([A("password"),null],a("auth.passwordChange.mustMatch")),phoneNumber:o.string(a("user.fields.phoneNumber"),{required:!0}),invitationcode:o.string(a("user.fields.invitationcode"),{required:!0}),withdrawPassword:o.string(a("user.fields.withdrawPassword"),{required:!0}),captcha:I().required(a("user.fields.captcha")).test("captcha-match","Captcha does not match",function(r){return r===h})}),n=T({resolver:q.yupResolver(g),mode:"onSubmit",defaultValues:{email:"",password:"",newPasswordConfirmation:"",phoneNumber:"",withdrawPassword:"",invitationcode:"",captcha:""}});s.useEffect(()=>{i(N.doClearErrorMessage())},[i]);const w=s.useCallback(()=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let c="";for(let l=0;l<6;l++)c+=r.charAt(Math.floor(Math.random()*r.length));C(c),n.setValue("captcha",""),n.clearErrors("captcha")},[n]),y=s.useCallback(r=>{const{email:c,password:l,phoneNumber:E,withdrawPassword:P,invitationcode:S}=r;i(N.doRegisterEmailAndPassword(c,l,E,P,S))},[i]),v=s.useCallback(()=>{p.goBack()},[p]);return s.useCallback(()=>{b(!u)},[u]),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",style:{display:"flex"},children:[e.jsx("div",{className:"back-button",onClick:v,style:{cursor:"pointer"},children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsx("div",{className:"page-title",children:"SIGN UP"})]}),e.jsx(R,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(y),className:"form-section",children:[e.jsx(t,{type:"email",name:"email",placeholder:"Enter your email",className:"text-input",externalErrorMessage:m,autoComplete:"email",label:"Email"}),e.jsx(t,{type:"tel",name:"phoneNumber",placeholder:"Enter your phone number",className:"text-input",autoComplete:"tel",label:"Phone Number"}),e.jsx("label",{className:"input-label",children:"Graphical Captcha"}),e.jsxs("div",{className:"captcha-container",children:[e.jsx("div",{className:"captcha-display",children:e.jsx("div",{className:"captcha-text",children:h})}),e.jsxs("div",{className:"captcha-controls",children:[e.jsxs("div",{className:"refresh-captcha",onClick:w,children:[e.jsx("i",{className:"fas fa-sync-alt"}),e.jsx("span",{children:"Refresh"})]}),e.jsx(t,{type:"text",name:"captcha",placeholder:"Enter code",className:"captcha-input"})]})]}),e.jsx(t,{type:u?"text":"password",name:"password",placeholder:"Create a password",className:"text-input",autoComplete:"new-password",label:"Password"}),e.jsx(t,{type:"password",name:"newPasswordConfirmation",placeholder:"Confirm your password",className:"text-input",autoComplete:"new-password",label:"Confirm Password"}),e.jsx(t,{type:"text",name:"withdrawPassword",placeholder:"Enter the withdraw Password",className:"text-input",externalErrorMessage:m,label:"withdraw Password"}),e.jsx(t,{type:"text",name:"invitationcode",placeholder:"Enter invitation code",className:"text-input",externalErrorMessage:m,label:"Invitation Code"}),e.jsxs("button",{className:"signup-button",disabled:d,type:"submit",children:[e.jsx(B,{loading:d}),e.jsx("span",{children:d?"CREATING...":"CREATE ACCOUNT"})]})]})}),e.jsx("div",{className:"footer-links",style:{textAlign:"center",margin:"20px 0"},children:e.jsx(j,{to:"/auth/signin",className:"footer-link",children:"Already have an account? Log in"})}),e.jsxs("div",{className:"terms",children:["By creating an account, you agree to our"," ",e.jsx(j,{to:"/terms-of-use",className:"remove_blue",children:"Terms of Service"})]})]})}export{D as default};
