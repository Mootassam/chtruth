import{y as S,u as w,k as x,o as a,X as M,p as e,a7 as A,_ as q,a8 as f,j as s,L as b}from"./index-4cd6ea8b.js";import{a as i,u as F,y as B,F as I}from"./FormErrors-7891a2f4.js";import{I as t}from"./InputFormItem-826cf1a5.js";import{B as L}from"./ButtonIcon-480d05cc.js";import{u as R}from"./useDispatch-1f91c277.js";function X(){const o=R(),m=S(),p=w(x.selectLoading),d=w(x.selectErrorMessage),[u,N]=a.useState(!1),[h,j]=a.useState("");a.useEffect(()=>{g()},[]);const v=M().shape({email:i.string(e("user.fields.username"),{required:!0}),password:i.string(e("user.fields.password"),{required:!0,min:8}),newPasswordConfirmation:i.string(e("user.fields.newPasswordConfirmation"),{required:!0}).oneOf([A("password"),null],e("auth.passwordChange.mustMatch")),phoneNumber:i.string(e("user.fields.phoneNumber"),{required:!0}),invitationcode:i.string(e("user.fields.invitationcode"),{required:!0}),withdrawPassword:i.string(e("user.fields.withdrawPassword"),{required:!0}),captcha:q().required(e("user.fields.captcha")).test("captcha-match",e("pages.signup.captchaMismatch"),function(r){return r===h})}),l=F({resolver:B.yupResolver(v),mode:"onSubmit",defaultValues:{email:"",password:"",newPasswordConfirmation:"",phoneNumber:"",withdrawPassword:"",invitationcode:"",captcha:""}});a.useEffect(()=>{o(f.doClearErrorMessage())},[o]);const g=a.useCallback(()=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n="";for(let c=0;c<6;c++)n+=r.charAt(Math.floor(Math.random()*r.length));j(n),l.setValue("captcha",""),l.clearErrors("captcha")},[l]),y=a.useCallback(r=>{const{email:n,password:c,phoneNumber:P,withdrawPassword:k,invitationcode:E}=r;o(f.doRegisterEmailAndPassword(n,c,P,k,E))},[o]),C=a.useCallback(()=>{m.goBack()},[m]);return a.useCallback(()=>{N(!u)},[u]),s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"header",style:{display:"flex"},children:[s.jsx("div",{className:"back-button",onClick:C,style:{cursor:"pointer"},children:s.jsx("i",{className:"fas fa-arrow-left"})}),s.jsx("div",{className:"page-title",children:e("pages.signup.title")})]}),s.jsx(I,{...l,children:s.jsxs("form",{onSubmit:l.handleSubmit(y),className:"form-section",children:[s.jsx(t,{type:"email",name:"email",placeholder:e("pages.signup.placeholders.email"),className:"text-input",externalErrorMessage:d,autoComplete:"email",label:e("pages.signup.labels.email")}),s.jsx(t,{type:"tel",name:"phoneNumber",placeholder:e("pages.signup.placeholders.phoneNumber"),className:"text-input",autoComplete:"tel",label:e("pages.signup.labels.phoneNumber")}),s.jsx("label",{className:"input-label",children:e("pages.signup.labels.captcha")}),s.jsxs("div",{className:"captcha-container",children:[s.jsx("div",{className:"captcha-display",children:s.jsx("div",{className:"captcha-text",children:h})}),s.jsxs("div",{className:"captcha-controls",children:[s.jsxs("div",{className:"refresh-captcha",onClick:g,children:[s.jsx("i",{className:"fas fa-sync-alt"}),s.jsx("span",{children:e("pages.signup.refresh")})]}),s.jsx(t,{type:"text",name:"captcha",placeholder:e("pages.signup.placeholders.captcha"),className:"captcha-input"})]})]}),s.jsx(t,{type:u?"text":"password",name:"password",placeholder:e("pages.signup.placeholders.password"),className:"text-input",autoComplete:"new-password",label:e("pages.signup.labels.password")}),s.jsx(t,{type:"password",name:"newPasswordConfirmation",placeholder:e("pages.signup.placeholders.confirmPassword"),className:"text-input",autoComplete:"new-password",label:e("pages.signup.labels.confirmPassword")}),s.jsx(t,{type:"text",name:"withdrawPassword",placeholder:e("pages.signup.placeholders.withdrawPassword"),className:"text-input",externalErrorMessage:d,label:e("pages.signup.labels.withdrawPassword")}),s.jsx(t,{type:"text",name:"invitationcode",placeholder:e("pages.signup.placeholders.invitationCode"),className:"text-input",externalErrorMessage:d,label:e("pages.signup.labels.invitationCode")}),s.jsxs("button",{className:"signup-button",disabled:p,type:"submit",children:[s.jsx(L,{loading:p}),s.jsx("span",{children:p?e("pages.signup.creatingAccount"):e("pages.signup.createAccount")})]})]})}),s.jsx("div",{className:"footer-links",style:{textAlign:"center",margin:"20px 0"},children:s.jsx(b,{to:"/auth/signin",className:"footer-link",children:e("pages.signup.alreadyHaveAccount")})}),s.jsxs("div",{className:"terms",children:[e("pages.signup.terms.text")," ",s.jsx(b,{to:"/terms-of-use",className:"remove_blue",children:e("pages.signup.terms.link")})]})]})}export{X as default};
